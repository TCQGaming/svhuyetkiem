
NVngayUI.NVngayState = 1;
NVngayUI.Moicau = {{18	,1	,1391,	1},{18,	1,	1392,	1}};
NVngayUI.TaskNVngay_G = 5014; 
NVngayUI.TaskNVngay_HT= 1;---task hoàn thành nv
NVngayUI.TaskNVngay_CauHinh= 2;
NVngayUI.TaskNVngay_DemSL = 3;
NVngayUI.BuocNV = 4;
NVngayUI.DemSoQuaiGietDuoc = 5;
NVngayUI.TaskNVngay_NhanThuongNV = 6;
NVngayUI.ItemCountDown = {18,	1,	1395,	1};
NVngayUI.NVngay_PhanLoai = {"Tiêu Diệt Quái","Chế Tạo Item","Tìm Khoáng Vật","Tiêu Diệt Boss","Giết Người"};
NVngayUI.NVngay_Color = {"red","green"};
-- NVngayUI.TaskNVngay_Max = 3;
NVngayUI.NVngay_szMsg = "";
NVngayUI.DATA_NPC = {---code face
	[1]={"Thú Vương Tuần Du",2140,"Dược Vương Động 65",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[2]={"Ưng Kỵ Hoành Sơn",2155,"Cư Diên Trạch 65 ",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[3]={"Hắc Thủy Khinh Kỵ",2158,"Điểm Thương Sơn 65",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[4]={"Lâu La Ngưu Lan Trại",2141,"Phục Ngưu Sơn 65",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[5]={"Nam Đệ Tử Tà Giáo",2142,"Phục Ngưu Sơn 65",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[6]={"Hưởng Thủy Thần Xạ Thủ",2143,"Hưởng Thủy Động 65",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[7]={"Hưởng Thủy Khoái Đao",2144,"Hưởng Thủy Động 65",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[8]={"Hưởng Thủy Tử Sĩ",2145,"Hưởng Thủy Động 65",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[9]={"Cấm Quân Bắc Doanh",2146,"Hổ Khâu Kiếm Trì cấp 65",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[10]={"Cấm Quân Nam Doanh", 2148, "Hổ Khâu Kiếm Trì Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
	[11]={"Tinh Kỵ Binh", 2149, "Hổ Khâu Kiếm Trì Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
	[12]={"Hươu Rừng", 2150, "Bành Lãi Cổ Trạch Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[13]={"Khỉ Hoang", 2151, "Bành Lãi Cổ Trạch Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[14]={"Ngựa Hoang", 2152, "Bành Lãi Cổ Trạch Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[15]={"Khương Bộ Binh Hoành Sơn", 2153, "Cư Diên Trạch Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[16]={"Hổ Kỵ Hoành Sơn", 2154, "Cư Diên Trạch Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[17]={"Ưng Kỵ Hoành Sơn", 2155, "Cư Diên Trạch Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[18]={"Tinh Binh Ô Bố Trại", 2156, "Điểm Thương Sơn Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[19]={"Tuần Thủ Ô Bố Trại", 2157, "Điểm Thương Sơn Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[20]={"Hắc Thủy Khinh Kỵ", 2158, "Điểm Thương Sơn Cấp 65", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[21]={"Mãnh An Mưu Khắc Quân", 2159, "Phong Lăng Độ Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[22]={"Đà Thủ Tào Bang", 2160, "Phong Lăng Độ Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[23]={"Thôi Thủ Mã Bang", 2161, "Phong Lăng Độ Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[24]={"Nam Đệ Tử Tà Giáo", 2162, "Kê Quán Động Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[25]={"Nữ Đệ Tử Tà Giáo", 2163, "Kê Quán Động Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[26]={"Bốc Sư Tà Giáo", 2164, "Kê Quán Động Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[27]={"Nữ Ảnh", 2165, "Kiếm Các Thục Đạo Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[28]={"Nam Ảnh", 2166, "Kiếm Các Thục Đạo Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[29]={"Thần Hành Binh", 2167, "Kiếm Các Thục Đạo Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[30]={"Tống Khinh Kỵ Binh", 2168, "Thục Cương Sơn Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[31]={"Tống Thương Sĩ", 2169, "Thục Cương Sơn Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[32]={"Tống Nõ Thủ", 2170, "Thục Cương Sơn Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[33]={"Kiếm Khách Giang Hồ", 2171, "Cửu Nghi Khê Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[34]={"Đao Khách Giang Hồ", 2172, "Cửu Nghi Khê Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[35]={"Đại Nội Mật Thám", 2173, "Cửu Nghi Khê Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[36]={"Thần Tí Cung", 2174, "Mê Cung Sa Mạc Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[37]={"Mã Tặc Khinh Phủ Thủ", 2175, "Mê Cung Sa Mạc Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[38]={"Hắc Thủy Khoái Kỵ Binh", 2176, "Mê Cung Sa Mạc Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[39]={"Thổ Bố Tộc Nhân", 2177, "Hoàng Lăng Đoàn Thị Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[40]={"Thổ Bố Bốc Sư", 2178, "Hoàng Lăng Đoàn Thị Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[41]={"Tử Diện Võ Sĩ", 2179, "Hoàng Lăng Đoàn Thị Cấp 75", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[42]={"Cấm Vệ Quân Đại Kim", 2180, "Long Môn Thạch Quật Cấp 85", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[43]={"Phi Kỵ Binh Đại Kim", 2181, "Long Môn Thạch Quật Cấp 85", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[44]={"Bang Chúng Ảnh Hội", 2182, "Long Môn Thạch Quật Cấp 85", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[45]={"Lưu Vong Đao Binh", 2183, "Hoàng Hạc Lâu Cấp 85", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[46]={"Trú Thành Thủ Quân", 2184, "Hoàng Hạc Lâu Cấp 85", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
[47]={"Lưu Khấu", 2185, "Hoàng Hạc Lâu Cấp 85", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [48] = {"Thủ Quân Kiếm Môn", 2186, "Kiếm Môn Quan [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [49] = {"Hộ Quan Thiết Kỵ Binh", 2187, "Kiếm Môn Quan [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [50] = {"Hắc Thủy Vân Kỵ Binh", 2188, "Kiếm Môn Quan [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [51] = {"Bang Chúng Diêm Bang", 2189, "Tiến Cúc Động [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [52] = {"Khổ Công", 2190, "Tiến Cúc Động [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [53] = {"Bang Chúng Bắc Mã", 2191, "Tiến Cúc Động [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [54] = {"Giang Nam Nghĩa Sĩ", 2192, "Bang Nguyên Bí Động [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [55] = {"Đông Nam Nghĩa Sĩ", 2193, "Bang Nguyên Bí Động [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [56] = {"Giang Bắc Nghĩa Sĩ", 2194, "Bang Nguyên Bí Động [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [57] = {"Hoàng Lăng Khán Thủ", 2195, "Hoàng Lăng Tây Hạ [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [58] = {"Đao Thủ Phản Quân", 2196, "Hoàng Lăng Tây Hạ [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [59] = {"Cổn Đao Thủ", 2197, "Hoàng Lăng Tây Hạ [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [60] = {"Kỵ Binh Tây Hạ", 2198, "Thiên Long Tự [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [61] = {"Hộ Tự Tăng Binh", 2199, "Thiên Long Tự [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [62] = {"Dũng Sĩ Ô Man", 2200, "Thiên Long Tự [cấp 85]", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
  [63]={"Truy Binh Thát Đát",2253,"Sắc Lặc Xuyên cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [64]={"Kỵ Binh Kim Quốc",2254,"Sắc Lặc Xuyên cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [65]={"Đà Lôi Bộ Kỵ Binh",2255,"Sắc Lặc Xuyên cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [66]={"Đại Mạc Đao Khách",2256,"Sắc Lặc Xuyên cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [67]={"Quân Sĩ Tây Hạ",2257,"Gia Dụ Quan cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [68]={"Mật Bộ Sĩ Binh",2258,"Gia Dụ Quan cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [69]={"Thủ Quân Gia Dụ Quan",2259,"Gia Dụ Quan cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [70]={"Tái Ngoại Hào Lang",2260,"Gia Dụ Quan cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [71]={"Diệp Hầu Hoa Sơn",2261,"Hoa Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [72]={"Thủ Quân Hoa Sơn",2262,"Hoa Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [73]={"Dị Nhân Kiếm Khách",2263,"Hoa Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [74]={"Cường Tặc Hoa Sơn",2264,"Hoa Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [75]={"Phù Du Tán Binh",2265,"Thục Cương Bí Cảnh cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [76]={"Mâu Thủ Bí Cảnh",2266,"Thục Cương Bí Cảnh cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [77]={"Lang Trung Giang Hồ",2267,"Thục Cương Bí Cảnh cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [78]={"Sơn Miêu",2268,"Thục Cương Bí Cảnh cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [79]={"Độc Đồng Tử",2269,"Phong Đô Quỷ Thành cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [80]={"Quỷ Nô",2270,"Phong Đô Quỷ Thành cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [81]={"Quỷ Sứ",2271,"Phong Đô Quỷ Thành cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [82]={"Mai Cốt Binh",2272,"Phong Đô Quỷ Thành cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [83]={"Thợ Săn Hắc Miêu",2273,"Miêu Lĩnh cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [84]={"Man Nữ Tế Tư",2274,"Miêu Lĩnh cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [85]={"Thợ Săn Bạch Miêu",2275,"Miêu Lĩnh cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [86]={"Thủ Quân Miêu Lĩnh",2276,"Miêu Lĩnh cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [87]={"Sĩ Tử Trường Ca Môn",2277,"Vũ Di Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [88]={"Lâu La Hồng Y",2278,"Vũ Di Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [89]={"Lâu La Tử Y",2279,"Vũ Di Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [90]={"Hổ Hoang Hoa Nam",2280,"Vũ Di Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
  [91]={"Thủ Quân Vũ Lăng Sơn",2281,"Vũ Lăng Sơn cấp 95",500,1500000,{18,1,114,6,nil,2},"2 Huyền Tinh Cấp 6"},
	[92] = {"Hộ Thủ Hồng Thương", 2297, "Đại Vũ Đài cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [93] = {"Tỳ Nữ Hồng Thương", 2298, "Đại Vũ Đài cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [94] = {"Thiết Phủ Kim Binh", 2299, "Đại Vũ Đài cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [95] = {"Ải Kiếm Tú Nữ", 2300, "Đại Vũ Đài cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},	
    [96] = {"Hộ Thủ Hồng Thương", 2297, "Đại Vũ Đài cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [97] = {"Tỳ Nữ Hồng Thương", 2298, "Đại Vũ Đài cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [98] = {"Thiết Phủ Kim Binh", 2299, "Đại Vũ Đài cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [99] = {"Ải Kiếm Tú Nữ", 2300, "Đại Vũ Đài cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [100] = {"Sạn Đạo Ác Viên", 2301, "Tam Hiệp Sạn Đạo cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [101] = {"Sạn Đạo Tiều Tử", 2302, "Tam Hiệp Sạn Đạo cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [102] = {"Đà Thủ Giả Trang", 2303, "Tam Hiệp Sạn Đạo cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [103] = {"Sạn Đạo Xích Mãng", 2304, "Tam Hiệp Sạn Đạo cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [104] = {"Quái Mệnh Cổ Sư", 2305, "Xi Vưu Động cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [105] = {"Man Độc Thủ", 2306, "Xi Vưu Động cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [106] = {"U Cư Quái Khách", 2307, "Xi Vưu Động cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [107] = {"Phục Cầm Sinh", 2308, "Xi Vưu Động cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [108] = {"Tà Đồng", 2309, "Tỏa Vân Uyên cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [109] = {"Cô Tẩu", 2310, "Tỏa Vân Uyên cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [110] = {"Cổ Tâm Linh Tử", 2311, "Tỏa Vân Uyên cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [111] = {"Cổ Tâm Linh Nữ", 2312, "Tỏa Vân Uyên cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [112] = {"Cẩm Mao Báo", 2313, "Báo_Phục Lưu Động cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [113] = {"Thiết Giác Man Binh", 2314, "Phục Lưu Động cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [114] = {"Phục Lưu Ngạc", 2315, "Phục Lưu Động cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [115] = {"Phản Quân Mâu Thủ", 2316, "Phục Lưu Động cấp 105", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [116] = {"Tê Giác Khôi", 2318, "Mông Cổ Vương Đình cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [117] = {"Thiết Đôn", 2319, "Mông Cổ Vương Đình cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [118] = {"Bạch Vũ Tiễn Sứ", 2320, "Mông Cổ Vương Đình cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [119] = {"Thiết Mã Tướng", 2321, "Mông Cổ Vương Đình cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [120] = {"Mâu Cổ Sứ", 2322, "Nguyệt Nha Tuyền cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [121] = {"Thiết Thủ Đao Khách", 2323, "Nguyệt Nha Tuyền cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [122] = {"Bách Độc Thủ", 2324, "Nguyệt Nha Tuyền cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [123] = {"Bạch Tu Tẩu", 2325, "Nguyệt Nha Tuyền cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [124] = {"Vô Diêm Hồn", 2326, "Tàn Tích Cung A Phòng cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [125] = {"Ải Yên Tẩu", 2327, "Tàn Tích Cung A Phòng cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [126] = {"Quỷ Diện Sinh", 2328, "Tàn Tích Cung A Phòng cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [127] = {"Tàn Tích Dã Sứ", 2329, "Tàn Tích Cung A Phòng cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [128] = {"Hành Sơn Hổ", 2330, "Lương Sơn Bạc cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [129] = {"Hành Sơn Thú", 2331, "Lương Sơn Bạc cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [130] = {"Xích Cước Sơn Khách", 2332, "Lương Sơn Bạc cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [131] = {"Man Chùy", 2333, "Man Chùy_Lương Sơn Bạc cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [132] = {"Đoạt Mệnh Hoa Khôi", 2334, "Thần Nữ Phong cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [133] = {"Mị Ảnh", 2335, "Thần Nữ Phong cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [134] = {"Mê Hồn Thủ", 2336, "Thần Nữ Phong cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [135] = {"Nhiếp Tâm Mi", 2337, "Thần Nữ Phong cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [136] = {"Vũ Linh Tế Tự", 2338, "Tàn Tích Dạ Lang cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [137] = {"Phạn Chú Tăng", 2339, "Tàn Tích Dạ Lang cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [138] = {"Đạo Mộ Tặc", 2340, "Tàn Tích Dạ Lang cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [139] = {"Thú Hồn Cư Sĩ", 2341, "Tàn Tích Dạ Lang cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [140] = {"Điệp Ảnh Côn", 2342, "Cổ Lãng Dữ cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [141] = {"Lãng Kiếm Khách", 2343, "Cổ Lãng Dữ cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [142] = {"Cổ Lãng Tu Sĩ", 2344, "Cổ Lãng Dữ cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [143] = {"Lãng Đao Khách", 2345, "Cổ Lãng Dữ cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [144] = {"Ma Cổ Đồng", 2346, "Đào Hoa Nguyên cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [145] = {"Vô Tâm Thú", 2347, "Đào Hoa Nguyên cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [146] = {"Lang Nha Mãnh Sĩ", 2348, "Đào Hoa Nguyên cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
    [147] = {"Thất Tâm Nho", 2349, "Đào Hoa Nguyên cấp 115", 500, 1500000, {18, 1, 114, 6, nil, 2}, "2 Huyền Tinh Cấp 6"},
};
------------- Cá nhân 
NVngayUI.HONOR_CLASS_MONEY		= 8;	
NVngayUI.tbHonorLevelInfo	= {
	["money"]	= {
		nHonorId	= NVngayUI.HONOR_CLASS_MONEY,
	},
};
function NVngayUI:NhanNVNgay_ondialog()
    local nDate = tonumber(GetLocalDate("%y%m%d"))
    if me.GetTask(5014, 7) < nDate then
        me.SetTask(5014, 7, nDate)
        me.SetTask(5014, 4, 0) -- Bắt đầu lại NV
    end
    local nCount = me.GetTask(5014, 4)
    if nCount >= 3 then
        Dialog:Say("Mỗi ngày chỉ được làm 3 nhiệm vụ")
        return 0
    end
    local szMsg = "Ở đây ta có một số nhiệm vụ cần ngươi giúp:\n<color=cyan>Cấp nào nhận được loại quái của map theo cấp đó "
  local nTaskId = me.GetTask(NVngayUI.TaskNVngay_G, NVngayUI.DemSoQuaiGietDuoc)
    local tbOpt = {"Để lần sau "};
	-- if nTaskId < 500 then
    -- table.insert(tbOpt, 1, {"<color=cyan>Nhiệm Vụ<color>:<color=yellow> Diệt Quái Lĩnh Thưởng<color>\n", self.NVNgay_NhanNV, self})
   -- table.insert(tbOpt, 1, {"<color=cyan>Tiếp nhận Nhiệm Vụ Ngày Cá Nhân<color>", self.NVNgay_ChonNhiemVu, self, 1}) -- Trang đầu tiên
   table.insert(tbOpt, 1, {"<color=cyan>Nhiệm Vụ Ngày Toàn Tổ Đội<color>", self.NVNgay_ChonNhiemVu_ToanPT, self, 1}) -- Trang đầu tiên
	-- elseif nTaskId >= 500 then 
        -- table.insert(tbOpt, 1, {"<color=green>Nhận thưởng nhiệm vụ<color>", self.NVNgay_NhanThuongNV, self})
			-- end 
    Dialog:Say(szMsg, tbOpt)
end

function NVngayUI:NVNgay_ChonNhiemVu(nPage)
    local nLevel = me.nLevel
    local nMaxPerPage = 10 -- Số lượng nhiệm vụ hiển thị trên mỗi trang
    local nTotalTasks = #NVngayUI.DATA_NPC
    local nTotalPages = math.ceil(nTotalTasks / nMaxPerPage)
    local nStartIndex = 1
    local nEndIndex = nMaxPerPage
		if nLevel < 69 then
        nStartIndex = 1
        nEndIndex = 20
	 elseif nLevel < 80 then
        nStartIndex = 21
        nEndIndex = 41
	elseif nLevel < 90 then
        nStartIndex = 42
        nEndIndex = 62
	 elseif nLevel < 100 then
        nStartIndex = 63
        nEndIndex = 91
	 elseif nLevel < 115 then
        nStartIndex = 92
        nEndIndex = 115
    else
        nStartIndex = 116
        nEndIndex = nTotalTasks
    end
	
    nStartIndex = (nPage - 1) * nMaxPerPage + nStartIndex
    nEndIndex = math.min(nStartIndex + nMaxPerPage - 1, nEndIndex)

    local szMsg = "Hãy chọn một nhiệm vụ từ danh sách bên dưới:\n"
    local tbOpt = {}
    for i = nStartIndex, nEndIndex do
        local data = NVngayUI.DATA_NPC[i]
        local nBuocNV = i
        local szOption = string.format("%s <color=green>[%s]", data[1], data[3])
        table.insert(tbOpt, {szOption, self.NVNgay_ChonNhiemVuConfirm, self, nBuocNV})
    end

    if nPage < nTotalPages then
        local szNextPageOption = "<color=gold>Xem Trang Sau"
        table.insert(tbOpt, {szNextPageOption, self.NVNgay_ChonNhiemVu, self, nPage + 1})
    end
    local szEndDialogOption = "Kết thúc đối thoại"
    table.insert(tbOpt, {szEndDialogOption, self.EndDialog, self})
    Dialog:Say(szMsg, tbOpt)
end


local partyKillCount = {} -- Bảng lưu trữ số quái vật đã giết của mỗi nhóm

function NVngayUI:NVNgay_ChonNhiemVuConfirm(nBuocNV)
	------Lưu phần tử của mảng NPC được chọn
me.SetTask(5014, 9, nBuocNV)
------------------------------------------------------------------ 
    local nTeamId = me.nTeamId
    partyKillCount[nTeamId] = partyKillCount[nTeamId] or 0 -- Khởi tạo biến đếm quái vật đã giết của nhóm nếu chưa tồn tại
    
    local nSoLuotHoanThanh = me.GetTask(5014, 4)
    local nDemSoQuaiGiet = me.GetTask(NVngayUI.TaskNVngay_G, NVngayUI.DemSoQuaiGietDuoc)
    
    local szMsg = "Nhiệm Vụ hiện tại: <color=cyan>"..nSoLuotHoanThanh.."/ 3 \n <color>\n"
    szMsg = szMsg.." + Tiêu Diệt : <color=green>"..NVngayUI.DATA_NPC[nBuocNV][4].." Quái<color> \n + Tên Quái : <color=green>"..NVngayUI.DATA_NPC[nBuocNV][1].."<color>\n + Bản đồ :    <color=green>"..NVngayUI.DATA_NPC[nBuocNV][3].."<color>\n\n"
    szMsg = szMsg.."Phần Thưởng :\n + <color=yellow>"..NVngayUI.DATA_NPC[nBuocNV][5].." Kinh Nghiệm<color> \n + <color=yellow>5 Vạn Đồng Khóa<color>\n + <color=yellow>"..NVngayUI.DATA_NPC[nBuocNV][7].."<color>\n\n"
    NVngayUI.NVngay_szMsg = NVngayUI.NVngay_szMsg..""..szMsg..""
    szMsg = szMsg.."Tiến Trình Thực Hiện :\n + Đã Diệt <color=green>"..nDemSoQuaiGiet + NVngayUI.GetTotalPartyKillCount().."/"..NVngayUI.DATA_NPC[nBuocNV][4].."<color>"
    
    local tbOpt = {}
    if nDemSoQuaiGiet + NVngayUI.GetTotalPartyKillCount() <= 0 then
        table.insert(tbOpt, 1, {"Nhận làm nhiệm vụ", self.NVNgay_NhanDiLamNV, self, szMsg})
    elseif nDemSoQuaiGiet + NVngayUI.GetTotalPartyKillCount() >= 500 then
        table.insert(tbOpt, 1, {"<color=green>Nhận thưởng nhiệm vụ<color>", self.NVNgay_NhanThuongNV, self})
    end
    
    Dialog:Say(szMsg, tbOpt)
end


function NVngayUI:NVNgay_NhanDiLamNV(szMsg)
	me.SetTask(NVngayUI.TaskNVngay_G,NVngayUI.TaskNVngay_CauHinh,1);
	Dialog:SendBattleMsg(me,szMsg, 1);
	Dialog:ShowBattleMsg(me, 1, 0);				
end
function NVngayUI:NVNgay_NhanThuongNV()
	local nBuocNV =me.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.BuocNV)+1;
	local nTaskCheckNhanThuong =me.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.TaskNVngay_NhanThuongNV)
	if nTaskCheckNhanThuong== 1 then
	Dialog:Say("Bạn đã nhận thưởng rồi");
	return;
end
	if me.CountFreeBagCell() < 5 then
		Dialog:Say("Hành Trang không đủ chỗ trống.Hãy sắp xếp còn trống 5 ô rồi quay lại gặp ta！");
		return 0;
	end
	local nTaskMuaLaiNVNgay = me.GetTask(5014, 8)
	me.SetTask(5014,8,nTaskMuaLaiNVNgay +1)
	me.SetTask(5014, 9, 0)
	me.AddStackItem(unpack(NVngayUI.DATA_NPC[nBuocNV][6]));-----Huyền tinh
		local nDiemHoatDong = me.GetTask(9177,1) --DAY
		me.SetTask(9177,1,nDiemHoatDong +1);
		me.Msg("<color=yellow>Nhận thành công (+1 điểm hoạt động)<color>");
	me.AddBindCoin(50000);	----- Đồng khóa
	local nTaskBuocNV =me.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.BuocNV);
	me.SetTask(NVngayUI.TaskNVngay_G,NVngayUI.BuocNV,nTaskBuocNV+1);
	local nDemSoQuaiGiet = me.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.DemSoQuaiGietDuoc);
	me.SetTask(NVngayUI.TaskNVngay_G,NVngayUI.DemSoQuaiGietDuoc,0);
	me.SetTask(NVngayUI.TaskNVngay_G,NVngayUI.TaskNVngay_CauHinh,0);
	me.AddExp(NVngayUI.DATA_NPC[nBuocNV][5]);
	Dialog:SendBlackBoardMsg(me, "Nhận thưởng nhiệm vụ thứ "..nBuocNV.." Thành Công !");
end

-------------- Toàn tổ đội 

function NVngayUI:NVNgay_ChonNhiemVu_ToanPT(nPage)
    local nLevel = me.nLevel
    local nMaxPerPage = 10 -- Số lượng nhiệm vụ hiển thị trên mỗi trang
    local nTotalTasks = #NVngayUI.DATA_NPC
    local nTotalPages = math.ceil(nTotalTasks / nMaxPerPage)
    local nStartIndex = 1
    local nEndIndex = nMaxPerPage
		if nLevel < 69 then
        nStartIndex = 1
        nEndIndex = 20
	 elseif nLevel < 80 then
        nStartIndex = 21
        nEndIndex = 41
	elseif nLevel < 90 then
        nStartIndex = 42
        nEndIndex = 62
	 elseif nLevel < 100 then
        nStartIndex = 63
        nEndIndex = 91
	 elseif nLevel < 115 then
        nStartIndex = 92
        nEndIndex = 115
    else
        nStartIndex = 116
        nEndIndex = nTotalTasks
    end
	
    nStartIndex = (nPage - 1) * nMaxPerPage + nStartIndex
    nEndIndex = math.min(nStartIndex + nMaxPerPage - 1, nEndIndex)

    local szMsg = "Hãy chọn một nhiệm vụ từ danh sách bên dưới:\n"
    local tbOpt = {}
    for i = nStartIndex, nEndIndex do
        local data = NVngayUI.DATA_NPC[i]
        local nBuocNV = i
        local szOption = string.format("%s <color=green>[%s]", data[1], data[3])
        table.insert(tbOpt, {szOption, self.NVNgay_ChonNhiemVuConfirm_ToanPT, self, nBuocNV})
    end

    if nPage < nTotalPages then
        local szNextPageOption = "<color=gold>Xem Trang Sau"
        table.insert(tbOpt, {szNextPageOption, self.NVNgay_ChonNhiemVu_ToanPT, self, nPage + 1})
    end
    local szEndDialogOption = "Kết thúc đối thoại"
    table.insert(tbOpt, {szEndDialogOption, self.EndDialog, self})
    Dialog:Say(szMsg, tbOpt)
end



function NVngayUI:NVNgay_ChonNhiemVuConfirm_ToanPT(nBuocNV)
    local nTeamId = me.nTeamId
    partyKillCount[nTeamId] = partyKillCount[nTeamId] or 0 -- Khởi tạo biến đếm quái vật đã giết của nhóm nếu chưa tồn tại
    local tbMember = KTeam.GetTeamMemberList(me.nTeamId); -- Đây là thông tin tổ đội
    if not tbMember then
        Dialog:Say("Bạn chưa tổ đội!")
        return 0
    end

    if me.nId ~= tbMember[1] then
        Dialog:Say("Hãy bảo đội trưởng đến gặp ta!")
        return 0
    end
		  local nMapId, nPosX, nPosY = me.GetWorldPos()		
		for _, nPlayerId in ipairs(tbMember) do
		local pPlayer = KPlayer.GetPlayerObjById(nPlayerId)
		local playerName = pPlayer and pPlayer.szName or "ID: " .. nPlayerId
		if  pPlayer then
		   if pPlayer.GetCamp() == 0 then
           local szMsg = "<color=yellow>Trong đội các ngươi " .. playerName .. " chưa gia nhập môn phái không thể nhận nhiệm vụ"
			KTeam.Msg2Team(me.nTeamId, szMsg)
            return 0
        end
			 local nDate = tonumber(GetLocalDate("%y%m%d"))
			if pPlayer.GetTask(5014, 7) < nDate then
				pPlayer.SetTask(5014, 7, nDate)
				pPlayer.SetTask(5014, 4, 0) -- Bắt đầu lại NV
			end
		
		    local nCount = pPlayer.GetTask(5014, 4)
			if nCount >= 3 then
				local szMsg = "Trong tổ đội của các hạ ta thấy " .. playerName .. " đã hoàn thành tối đa 3 nhiệm vụ"
				KTeam.Msg2Team(me.nTeamId, szMsg);	
			return 0
			end
			
				local nGioiHanTaiPhu = ConfigAll.GioiHanTaiPhuNVN
	for szType, tbTypeInfo in pairs(self.tbHonorLevelInfo) do
		local nHonorId		= tbTypeInfo.nHonorId;
			local nHonorValue	= PlayerHonor:GetPlayerHonor(pPlayer.nId, nHonorId, 0);
    if nHonorValue < nGioiHanTaiPhu then
        Dialog:Say("Thành viên " .. playerName .. " Tài phú hiện nay là :<color=yellow> "..nHonorValue.."<color> không đạt đủ<color=yellow> "..nGioiHanTaiPhu.." <color>điểm Tài Phú để tham gia");
        return 0;
    end
	end 

        if pPlayer.nMapId ~= nMapId then
           local szMsg = "Trong đội các ngươi " .. playerName .. " không ở gần đây, không thể nhận nhiệm vụ"
			KTeam.Msg2Team(me.nTeamId, szMsg)
            return 0
        end
		else 
			local szMsg = "Ta thấy tổ đội của ngươi có thành viên không đứng cùng map với đội trưởng không thể xem nhiệm vụ"
            KTeam.Msg2Team(me.nTeamId, szMsg)
			return 0 
		end
	end
	
	for _, nPlayerId in ipairs(tbMember) do
	local pPlayer = KPlayer.GetPlayerObjById(nPlayerId)
    local playerName = pPlayer and pPlayer.szName or "ID: " .. nPlayerId	
	------Lưu phần tử của mảng NPC được chọn
		pPlayer.SetTask(5014, 9, nBuocNV)
------------------------------------------------------------------ 
    
    local nSoLuotHoanThanh = pPlayer.GetTask(5014, 4)
    local nDemSoQuaiGiet = pPlayer.GetTask(NVngayUI.TaskNVngay_G, NVngayUI.DemSoQuaiGietDuoc)
    
-- Tiến Trình Thực Hiện :
local tbKillCountMsg = "<color=red>Tiến Trình Thực Hiện :<color>\n"
local tbCountNvMsg = "<color=red>Nhiệm Vụ hiện tại:<color>\n"
local tbNhiemVu = "<color=red>Nhiệm vụ đang xem yêu cầu:<color>\n"
local bAllMembersCompleted = true  -- Biến kiểm tra xem tất cả thành viên đã hoàn thành nhiệm vụ chưa
for _, nPlayerId in ipairs(tbMember) do
    local pPlayer = KPlayer.GetPlayerObjById(nPlayerId)

    if pPlayer then
        local playerName = pPlayer.szName
        local playerKillCount = pPlayer.GetTask(NVngayUI.TaskNVngay_G, NVngayUI.DemSoQuaiGietDuoc) or 0
		local playerMissionCount = pPlayer.GetTask(5014, 4) or 0  -- Thêm dòng này để lấy số nhiệm vụ của ngày cho từng thành viên
        tbCountNvMsg = tbCountNvMsg .. " + <color=yellow>" .. playerName .. "<color> đã hoàn thành <color=cyan>" .. playerMissionCount .. "<color> nhiệm vụ.\n"
        tbKillCountMsg = tbKillCountMsg .. " + <color=yellow>" .. playerName .. "<color> đã diệt " .. playerKillCount .. " quái.\n"
		if pPlayer.GetTask(5014, 5) < 500 then
            bAllMembersCompleted = false
        end
    end
end

local szMsg = ""
szMsg = szMsg .. tbCountNvMsg
szMsg = szMsg .. tbKillCountMsg
szMsg = szMsg .. tbNhiemVu 
szMsg = szMsg .. " + Tiêu Diệt : <color=green>" .. NVngayUI.DATA_NPC[nBuocNV][4] .. " Quái<color> \n + Tên Quái : <color=green>" .. NVngayUI.DATA_NPC[nBuocNV][1] .. "<color>\n + Bản đồ :    <color=green>" .. NVngayUI.DATA_NPC[nBuocNV][3] .. "<color>\n"
szMsg = szMsg .. "<color=red>Phần Thưởng<color>:\n + <color=yellow>" .. NVngayUI.DATA_NPC[nBuocNV][5] .. " Kinh Nghiệm<color> \n + <color=yellow>5 Vạn Đồng Khóa<color>\n + <color=yellow>" .. NVngayUI.DATA_NPC[nBuocNV][7] .. "<color>\n\n"
NVngayUI.NVngay_szMsg = NVngayUI.NVngay_szMsg .. "" .. szMsg .. ""
    local tbOpt = {}
	local playerKillCount = pPlayer.GetTask(NVngayUI.TaskNVngay_G, NVngayUI.DemSoQuaiGietDuoc) or 0
    if not bAllMembersCompleted then
        table.insert(tbOpt, 1, {"Nhận làm nhiệm vụ toàn tổ đội", self.NVNgay_NhanDiLamNV_ToanPT, self, szMsg})
	else 
        table.insert(tbOpt, 1, {"<color=green>Nhận thưởng nhiệm vụ toàn pt<color>", self.NVNgay_NhanThuongNV_ToanPT, self})
    end
    Dialog:Say(szMsg, tbOpt)
end
end 

-- Hàm để lấy tổng số quái vật đã giết của tổ đội
function NVngayUI.GetTotalPartyKillCount()
    local totalKillCount = 0
    for _, count in pairs(partyKillCount) do
        totalKillCount = totalKillCount + count
    end
    return totalKillCount
end

-- Cập nhật số quái vật đã giết của tổ đội
function NVngayUI:UpdatePartyKillCount(nTeamId, nCount)
    partyKillCount[nTeamId] = nCount
end


function NVngayUI:NVNgay_NhanDiLamNV_ToanPT(szMsg,pPlayer)
    local tbMember = KTeam.GetTeamMemberList(me.nTeamId); -- Đây là thông tin tổ đội
    if not tbMember then
        Dialog:Say("Bạn chưa tổ đội!")
        return 0
    end

    if me.nId ~= tbMember[1] then
        Dialog:Say("Hãy bảo đội trưởng đến gặp ta!")
        return 0
    end
	
	local nMapId, nPosX, nPosY = me.GetWorldPos()
	for _, nPlayerId in ipairs(tbMember) do
		local pPlayer = KPlayer.GetPlayerObjById(nPlayerId)
	pPlayer.SetTask(NVngayUI.TaskNVngay_G,NVngayUI.TaskNVngay_CauHinh,1);
	Dialog:SendBattleMsg(pPlayer,szMsg, 1);
	Dialog:ShowBattleMsg(pPlayer, 1, 0);		
end 	
end

function NVngayUI:NVNgay_NhanThuongNV_ToanPT()
    local tbMember = KTeam.GetTeamMemberList(me.nTeamId); -- Đây là thông tin tổ đội
    if not tbMember then
        Dialog:Say("Bạn chưa tổ đội!")
        return 0
    end

    if me.nId ~= tbMember[1] then
        Dialog:Say("Hãy bảo đội trưởng đến gặp ta!")
        return 0
    end
	
	local nMapId, nPosX, nPosY = me.GetWorldPos()
	for _, nPlayerId in ipairs(tbMember) do
		local pPlayer = KPlayer.GetPlayerObjById(nPlayerId)
	local playerName = pPlayer and pPlayer.szName or "ID: " .. nPlayerId;  -- Lấy tên nếu có, ngược lại hiển thị ID
	local nBuocNV =pPlayer.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.BuocNV)+1;
	local nTaskCheckNhanThuong =pPlayer.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.TaskNVngay_NhanThuongNV)
	local nDemSoQuaiGiet = pPlayer.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.DemSoQuaiGietDuoc);
	if nDemSoQuaiGiet < 1 then 
	 local szMsg = "<color=yellow>Trong đội các ngươi " .. playerName .. " chưa giết đủ số quái vật"
	KTeam.Msg2Team(me.nTeamId, szMsg)
	return 0;
	end 
	if nTaskCheckNhanThuong == 1 then
           local szMsg = "<color=yellow>Trong đội các ngươi " .. playerName .. " đã nhận thưởng rồi mà"
			KTeam.Msg2Team(me.nTeamId, szMsg)
		return 0;
	end
	if pPlayer.CountFreeBagCell() < 5 then
		    local szMsg = "Hành Trang " .. playerName .. " không đủ 5 chỗ trống.Hãy sắp xếp còn trống 5 ô rồi"
			KTeam.Msg2Team(me.nTeamId, szMsg)
		return 0;
	end
	     if pPlayer.nMapId ~= nMapId then
           local szMsg = "<color=yellow>Trong đội các ngươi " .. playerName .. " không ở gần đây, không thể nhận thưởng"
			KTeam.Msg2Team(me.nTeamId, szMsg)
            return 0
        end
	end 
	
	for _, nPlayerId in ipairs(tbMember) do
		local pPlayer = KPlayer.GetPlayerObjById(nPlayerId)
	local nBuocNV =pPlayer.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.BuocNV)+1;
	local nTaskMuaLaiNVNgay = pPlayer.GetTask(5014, 8)
	pPlayer.SetTask(5014,8,nTaskMuaLaiNVNgay +1)
	pPlayer.SetTask(5014, 9, 0)
	pPlayer.AddStackItem(unpack(NVngayUI.DATA_NPC[nBuocNV][6]));-----Huyền tinh
		local nDiemHoatDong = pPlayer.GetTask(9177,1) --DAY
		pPlayer.SetTask(9177,1,nDiemHoatDong +1);
		pPlayer.Msg("<color=yellow>Nhận thành công (+1 điểm hoạt động)<color>");
	pPlayer.AddBindCoin(50000);	----- Đồng khóa
	local nTaskNVHoangKim = pPlayer.GetTask(9055,6)
	pPlayer.SetTask(9055,6, nTaskNVHoangKim + 1);------Nhiệm vụ ngày hoàng kim
	local nMoKhamNam = ConfigAll.OpenKham
	local nSoLuongRuongDa = ConfigAll.nSoRuong_NhiemVuNgay	
		-- if nMoKhamNam == 1 then 
		-- pPlayer.AddStackItem(18,1,1303,1,nil,nSoLuongRuongDa)
		-- end 
		 	local nEvent = ConfigAll.KhoiDong_NL_Event_TongKim
			local NguyenLieu_Event = ConfigAll.NguyenLieu_Event
					if nEvent == 1 then 
					me.AddStackItem(NguyenLieu_Event[1], NguyenLieu_Event[2], NguyenLieu_Event[3], NguyenLieu_Event[4],nil,5);----50 Giỏ Event
					end 
	local nTaskBuocNV =pPlayer.GetTask(NVngayUI.TaskNVngay_G,NVngayUI.BuocNV);
	pPlayer.SetTask(NVngayUI.TaskNVngay_G,NVngayUI.BuocNV,nTaskBuocNV+1);
	pPlayer.SetTask(NVngayUI.TaskNVngay_G,NVngayUI.DemSoQuaiGietDuoc,0);
	pPlayer.SetTask(NVngayUI.TaskNVngay_G,NVngayUI.TaskNVngay_CauHinh,0);
	pPlayer.AddExp(NVngayUI.DATA_NPC[nBuocNV][5]);
	Dialog:SendBlackBoardMsg(pPlayer, "Nhận thưởng nhiệm vụ thứ "..nBuocNV.." Thành Công !");
end
end 

function NVngayUI:XuLyGietQuai()

end